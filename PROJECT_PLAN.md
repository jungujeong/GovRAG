# 사하구청 폐쇄망 RAG 시스템 프로젝트 계획서

## 프로젝트 목적
사하구청 내부 공문서(HWP/PDF)를 대상으로 한 폐쇄망 환경의 고성능 질의응답 시스템 구축. 할루시네이션 없는 Evidence-Only 방식으로 정확한 정보 제공과 근거 기반 답변을 통해 행정 업무 효율성 향상

## 개발 환경 및 도구

### 백엔드
- **언어**: Python 3.12+
- **프레임워크**: FastAPI, Uvicorn
- **검색 엔진**: Whoosh (BM25), ChromaDB (벡터 DB)
- **LLM**: Ollama (로컬 실행 - Llama3, Gemma2 등)
- **임베딩**: BGE-M3, KoE5, KR-SBERT (다단계 폴백)
- **문서 처리**: PyMuPDF, pytesseract (OCR), JPype1 (HWP)

### 프론트엔드
- **프레임워크**: React 18, Vite
- **스타일링**: Tailwind CSS
- **상태 관리**: Zustand
- **마크다운**: react-markdown

### 인프라
- **데이터베이스**: ChromaDB (DuckDB 백엔드), Redis (캐싱)
- **배포 환경**: 폐쇄망/오프라인 완전 지원
- **컨테이너**: Docker (옵션)

## 요구사항 분석

### 기능적 요구사항
1. **문서 처리**: HWP/PDF 파일의 텍스트 추출 및 구조 보존
2. **검색 성능**: 키워드 + 의미 기반 하이브리드 검색
3. **답변 정확도**: 문서 근거 기반 답변만 생성 (할루시네이션 방지)
4. **대화 연속성**: 후속 질문 처리 및 맥락 유지
5. **출처 추적**: 모든 답변에 정확한 출처 표시
6. **세션 관리**: 다중 사용자 세션 독립성 보장

### 비기능적 요구사항
1. **보안**: 폐쇄망 환경 완전 지원, 외부 의존성 제거
2. **성능**: 5초 이내 첫 응답, 동시 10명 이상 사용
3. **확장성**: 문서 10만 건 이상 처리 가능
4. **안정성**: 99% 이상 가동률
5. **사용성**: 직관적 UI, 공무원 업무 환경 최적화

## 구현 계획

### 1단계: 핵심 기능 안정화 (1-2주)
- [x] 현재 구현된 기능 검증 및 버그 수정
- [ ] 주제 전환 시 답변 품질 문제 해결
- [ ] 세션 예외처리 강화 (타임아웃, 동시성 처리)
- [ ] 에러 로깅 및 모니터링 체계 구축

### 2단계: 검색 성능 개선 (2-3주)
- [ ] 텍스트 전처리 파이프라인 고도화
  - 공문서 특화 정규화 규칙 추가
  - 표/도표 내용 구조화 처리
  - 문서 메타데이터 활용 강화
- [ ] 하이브리드 검색 가중치 자동 조정
- [ ] 리랭킹 모델 성능 최적화
- [ ] 검색 결과 캐싱 전략 구현

### 3단계: 대화 품질 향상 (3-4주)
- [ ] 프롬프트 엔지니어링
  - 모델별 최적 프롬프트 템플릿 개발
  - Few-shot 예제 통합
  - Chain-of-Thought 추론 적용
- [ ] 답변 형식 개선
  - 구조화된 답변 템플릿 (요약/상세/참고사항)
  - 표/리스트 자동 포맷팅
  - 전문용어 설명 자동 추가
- [ ] 대화 맥락 관리 고도화
  - 주제 변화 감지 알고리즘 개선
  - 대화 요약 품질 향상
  - 후속 질문 예측 및 제안

### 4단계: 사용자 경험 개선 (2-3주)
- [ ] UI/UX 개선
  - 답변 로딩 상태 시각화
  - 출처 문서 미리보기 기능
  - 검색 필터 및 정렬 옵션
  - 답변 내보내기 (PDF/Word)
- [ ] 요약 기능 고도화
  - 문서 전체 요약
  - 다중 문서 비교 요약
  - 시계열 변화 분석
- [ ] 접근성 강화
  - 스크린 리더 완벽 지원
  - 키보드 단축키 확장
  - 고대비 모드 개선

### 5단계: 운영 최적화 (2-3주)
- [ ] 성능 모니터링 대시보드
  - 실시간 응답 시간 추적
  - 검색 정확도 지표
  - 시스템 리소스 사용량
- [ ] 모델 성능 평가 자동화
  - A/B 테스트 프레임워크
  - 골든 데이터셋 확장
  - 정기 평가 리포트 생성
- [ ] 관리자 기능 강화
  - 문서 일괄 업로드/삭제
  - 인덱스 재구축 스케줄링
  - 사용자 피드백 수집/분석

### 6단계: 고급 기능 추가 (3-4주)
- [ ] 멀티모달 처리
  - 문서 내 이미지 OCR 개선
  - 도표/차트 내용 이해
  - 다이어그램 구조 분석
- [ ] 지능형 문서 분석
  - 문서 간 관계 매핑
  - 자동 태깅 및 분류
  - 중복/모순 내용 감지
- [ ] 협업 기능
  - 답변 공유 및 코멘트
  - 팀별 문서 권한 관리
  - 질문 템플릿 공유

## 테스트(검증) 계획

### 단위 테스트
- 문서 파서 정확도 테스트
- 검색 엔진 성능 벤치마크
- LLM 프롬프트 일관성 검증
- API 엔드포인트 기능 테스트

### 통합 테스트
- End-to-End 시나리오 테스트
- 다중 세션 동시성 테스트
- 대용량 문서 처리 부하 테스트
- 장시간 운영 안정성 테스트

### 사용자 수용 테스트
- 실제 공문서 기반 테스트
- 사용자 시나리오별 검증
- UI/UX 사용성 평가
- 성능 목표 달성 확인

### 평가 지표
- **검색 정확도**: Precision@K, Recall@K, MRR
- **답변 품질**: BLEU, ROUGE, BERTScore
- **시스템 성능**: 응답 시간, 처리량, 동시 사용자 수
- **사용자 만족도**: 답변 유용성, UI 편의성, 전반적 만족도

## 구현 계획별 일정(주 단위)

| 단계 | 기간 | 주요 산출물 |
|------|------|------------|
| 1단계: 핵심 기능 안정화 | 1-2주 | 안정화된 코어 시스템, 에러 처리 체계 |
| 2단계: 검색 성능 개선 | 3-4주 | 고도화된 검색 엔진, 캐싱 시스템 |
| 3단계: 대화 품질 향상 | 5-7주 | 최적화된 프롬프트, 구조화된 답변 시스템 |
| 4단계: 사용자 경험 개선 | 8-9주 | 개선된 UI/UX, 고급 요약 기능 |
| 5단계: 운영 최적화 | 10-11주 | 모니터링 대시보드, 평가 자동화 시스템 |
| 6단계: 고급 기능 추가 | 12-14주 | 멀티모달 처리, 지능형 분석 기능 |

**전체 일정**: 약 3-4개월

## 기대 효과 및 활용 방안

### 기대 효과
1. **업무 효율성 향상**
   - 문서 검색 시간 80% 단축
   - 정확한 근거 기반 의사결정 지원
   - 반복 질의 자동 처리

2. **정보 접근성 개선**
   - 방대한 문서를 자연어로 검색
   - 즉각적인 정보 획득
   - 문서 간 연관 정보 통합 제공

3. **행정 서비스 품질 향상**
   - 민원 응대 시간 단축
   - 일관된 정보 제공
   - 정책 결정 근거 자료 신속 확보

### 활용 방안
1. **민원 상담 지원**: 실시간 규정/지침 검색
2. **정책 수립 지원**: 과거 사례 및 데이터 분석
3. **내부 교육**: 신규 직원 온보딩, 업무 매뉴얼 검색
4. **감사 대응**: 증빙 자료 신속 검색 및 제공
5. **타 부서 확산**: 구청 전체 및 타 공공기관 적용

## 참고 문헌

### 기술 문서
- FastAPI Documentation: https://fastapi.tiangolo.com/
- Sentence Transformers: https://www.sbert.net/
- ChromaDB Documentation: https://docs.trychroma.com/
- Ollama Documentation: https://ollama.ai/
- React Documentation: https://react.dev/

### 연구 논문
- "Retrieval-Augmented Generation for Knowledge-Intensive NLP Tasks" (Lewis et al., 2020)
- "Dense Passage Retrieval for Open-Domain Question Answering" (Karpukhin et al., 2020)
- "ColBERT: Efficient and Effective Passage Search" (Khattab & Zaharia, 2020)
- "Evidence-Based Verification for Real-World Claim" (Thorne et al., 2018)

### 한국어 NLP 자료
- KoBERT: Korean BERT pre-trained models
- KoELECTRA: Korean ELECTRA models
- Korean NLP Datasets and Resources (KLUE Benchmark)
- 한국어 임베딩 (Korean Embeddings) - 박규병

### RAG 시스템 구현 사례
- LangChain RAG Tutorial
- Haystack Framework Documentation
- LlamaIndex (GPT Index) Examples
- Microsoft Semantic Kernel Patterns

---

*작성일: 2025년 1월 17일*
*버전: 1.0*